#!/usr/bin/env bash

set -u

tmux has-session -t main 2>&1 > /dev/null

if [ $? -ne "0" ]
then
    # does not exist, so create it
    tmux new -s main
else
    # exists, check number of clients
    NCLIENTS=$(tmux list-clients -t main | wc -l)
    if [ $NCLIENTS -eq "0" ]
    then
        # no clients, be the first one to attach to it
        tmux attach -t main
    else
        # has clients, so create a new unnamed session
        tmux new
    fi
fi
