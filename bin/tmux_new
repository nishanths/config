#!/usr/bin/env bash

set -u

MAIN_SESSION_NAME="0"

tmux has-session -t $MAIN_SESSION_NAME 2>&1 > /dev/null

if [ $? -ne "0" ]
then
    # does not exist, so create it
    tmux new -s $MAIN_SESSION_NAME
else
    # exists, check number of clients
    NCLIENTS=$(tmux list-clients -t $MAIN_SESSION_NAME | wc -l)
    if [ $NCLIENTS -eq "0" ]
    then
        # no clients, be the first one to attach to it
        tmux attach -t $MAIN_SESSION_NAME
    else
        # has clients, so create a new unnamed session
        tmux new
    fi
fi
